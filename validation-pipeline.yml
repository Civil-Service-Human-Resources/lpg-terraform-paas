trigger:
- idt-feature-*


pool:
  vmImage: ubuntu-latest
  
steps:
  - task: TerraformInstaller@0
    displayName: Install Terraform
    inputs:
      terraformVersion: 0.13.0

  # - task: AzureCLI@2
  #   displayName: Login to Azure CLI
  #   inputs:
  #     azureSubscription: 'PrincipalConnectionStaging'
  #     scriptType: 'bash'
  #     scriptLocation: 'inlineScript'
  #     inlineScript: 'az --version'

  - task: AzureCLI@2
    inputs:
      azureSubscription: 'PrincipalConnectionStaging'
      scriptType: 'bash'
      scriptLocation: 'inlineScript'
      inlineScript: |
        cd environments/master
        ../../scripts/ci/validate_envs.sh
      addSpnToEnvironment: true
      useGlobalConfig: true